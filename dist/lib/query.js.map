{"version":3,"file":"query.js","sourceRoot":"","sources":["../../src/lib/query.ts"],"names":[],"mappings":"AAAA,OAAO,MAAM,MAAM,yBAAyB,CAAC;AAC7C,MAAM,CAAC,KAAK,UAAU,WAAW;IAC7B,MAAM,GAAG,GAAG;;;;;;;;;;;;;;;;;;;;;KAqBX,CAAC;IAEF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACzC,OAAO,CAAC,GAAG,CAAC,mBAAmB,EAAE,IAAI,CAAC,CAAA;IACtC,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,WAAW;IAC7B,MAAM,GAAG,GAAG;;;;KAIX,CAAC;IAEF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;IAExC,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,UAAU,CAAC,OAAe,EAAE,IAAY,EAAE,OAAe;IAC3E,MAAM,GAAG,GAAG;;CAEf,CAAC;IAEE,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC,CAAA;AACrD,CAAC","sourcesContent":["import client from \"../config/connection.js\";\nexport async function getAllShops() {\n    const sql = `\n    SELECT\n    shops.id AS shop_id,\n    name AS shop_name,\n    address AS shop_address,\n    users.id AS user_id,\n    CONCAT(users.first_name, ' ', users.last_name) AS user_name,\n    users.email AS user_email,\n    CONCAT(managers.first_name, ' ', managers.last_name) AS manager,\n    wines.id AS wine_id,\n    brand AS wine_brand,    \n    type AS wine_type,\n    region AS wine_region,\n    price AS wine_price\nFROM shops\nJOIN users\n    ON shops.user_id = users.id\nLEFT JOIN wines\n    ON shops.id = wines.shop_id\nLEFT JOIN users as managers\n    ON users.manager_id = managers.id\n    `;\n\n    const { rows } = await client.query(sql);\n    console.log('get all shop rows', rows)\n    return rows;\n}\n\nexport async function getAllUsers() {\n    const sql = `\n    SELECT id, \n        CONCAT(first_name, ' ', last_name) AS user_name\n    FROM users\n    `;\n\n    const { rows } = await client.query(sql)\n\n    return rows;\n}\n\nexport async function createShop(user_id: number, name: string, address: string) {\n    const sql = `\n    INSERT INTO shops (name, address, user_id) VALUES ($1, $2, $3)\n`;\n\n    await client.query(sql, [name, address, user_id])\n}"]}